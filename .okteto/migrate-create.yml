name: web-core-synestra-io-dev-migrate-create

# Okteto Deploy-only manifest.
# Purpose: generate Payload migration files in dev namespace without `okteto up`.
# Note: files are created inside the job container; copy them out to Git.

deploy:
  - kubectl -n web-synestra-io-dev delete job web-synestra-io-dev-migrate-create --ignore-not-found
  - kubectl apply -f deploy/jobs/web-synestra-io-dev-migrate-create.yaml
  - kubectl -n web-synestra-io-dev wait --for=condition=complete job/web-synestra-io-dev-migrate-create --timeout=30m
  - kubectl -n web-synestra-io-dev logs job/web-synestra-io-dev-migrate-create
