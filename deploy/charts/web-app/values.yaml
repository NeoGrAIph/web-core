# Base values for `web-app` chart.
# Rule: no plaintext secrets in `web-core`. Provide secret names/keys only.

nameOverride: ""
fullnameOverride: ""

image:
  repository: "REPLACE_ME"
  tag: "REPLACE_ME"
  pullPolicy: IfNotPresent
  pullSecrets: []
  # - name: regcred

service:
  type: ClusterIP
  port: 3000

ingress:
  enabled: true
  className: "traefik"
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
  hosts: []
  # - host: corporate.dev.example.com
  #   paths:
  #     - path: /
  #       pathType: Prefix
  tls: []
  # - secretName: corporate-dev-tls
  #   hosts:
  #     - corporate.dev.example.com

env: {}
  # SYNESTRA_ENV: "dev" # dev|stage|prod
  # NEXT_PUBLIC_SERVER_URL: "https://corporate.dev.example.com"

envFrom:
  secretRef: ""
  # secretRef: web-corporate-dev-env

resources: {}
  # requests:
  #   cpu: 100m
  #   memory: 256Mi
  # limits:
  #   cpu: 500m
  #   memory: 1Gi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 2
  targetCPUUtilizationPercentage: 80

persistence:
  media:
    enabled: true
    mountPath: /app/public/media
    size: 5Gi
    storageClassName: ""

postgres:
  enabled: true
  clusterName: postgres
  instances: 1
  storage:
    size: 5Gi
    storageClassName: ""
  bootstrap:
    secretName: ""
    # secretName: web-corporate-dev-db-init
    database: ""
    # database: corporate
    owner: ""
    # owner: corporate
  appUserSecretName: ""
  # appUserSecretName: web-corporate-dev-db-app

migrations:
  enabled: true
  hook: PreSync
  hookDeletePolicy: BeforeHookCreation,HookSucceeded
  command:
    - sh
    - -lc
    - "pnpm --filter \"$APP_NAME\" payload migrate"
